sudo: required
dist: trusty
language: rust
cache:
- apt
- cargo
rust:
- nightly
before_script:
- export PATH=$HOME/.cargo/bin:$PATH
- cargo install cargo-travis || echo "cargo-travis already installed"
script:
- |
  cargo build &&
  cargo test
before_deploy:
- cargo build --release --target=x86_64-unknown-linux-gnu
- name="matrix-rocketchat-linux-x86_64"
- mkdir $name
- cp target/x86_64-unknown-linux-gnu/release/rust-release-test $name/
- cp LICENSE $name/
- tar czvf $name.tar.gz $name
deploy:
  provider: releases
  api_key:
    secure: pDVhTJcDXYag5R+I5At5rGHQMSx543kh0GN05QCz/h7psT+E8QAHPpeHk46x+RJRQ5gMLkOra866nkLqpB34q/U3a0Ya7LEe9yF2YDPRxQeltl9pwR8pcjXFg9UUNH8eTk3hdWh9apMLPIcYxagLWkXmowe01KhEr20Igp1WCPryMRV5AIHd/AcbF3D4rPzxSyDrBEvBYbbcneubBeLp2cYcQeForbVGAkGKooH4CcvE0TIUuuD/AtAYY7I5GFiNigROjCivpeY0mXo/VG3qCyMPpMAHEs5OpErFfdhELc1dgWT5tf99yidz7RGsnwyG/+84qbPC+NZkEytIolowT864sPWWdPbS1lBVwtv4Y1+lphsOTbzHEb38+65qEsZE1kM8V0AOhwkHtoRQTubZUtmSSV8y8Ni983Z5zs6uYCJIIJjdLCQk7Enhj0xYFcJlZkdCuNxdwu3d+goXpgM9NeNKjhd0rtF1Eo7H+Wpwodd92SHQJQpXHmUqEjdZp1j87muKSoA3AVx3QtgwbNfwVgz8pDA8fbwzUtrBzujBGyC+b/W84s8b+nh17VjNBtIteEJGKPkifBZ6vVQTsYdIsCqVbg3anxY8lXsGFr3ElJxJU/Ch03ygStEeAVv8rb5+ySaa9rV5pgNta/0z2JGkqvC1usSnjG6mxxoqhOe+M9w=
  file: matrix-rocketchat-linux-x86_64.tar.gz
  on:
    repo: lerux/rust-release-test
    tags: true